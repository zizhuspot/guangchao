---
title: 《信息安全工程师》学习第六天
date: 2023-8-27 23:29:00
categories:
  - 记录
tags:
  - 信息安全
  - 网络安全
  - 网络攻防
  - 病毒
  - 密钥
description: 基于中国软考《信息安全工程师》教材，将每天学习内容摘抄至此。
cover: https://s2.loli.net/2023/08/06/39iqWlh14pUZyGP.png
---
## 写在前面
本文全部内容摘自《信息安全工程师》教材，通过博客方式记录每天学习内容和进度。同时也让感兴趣的人能够一同学习。本文只作学习交流使用，如要商用，请联系该书出版社和作者，PS：博客内容偏理论，请知悉。如果侵权，请告知，立删博文！
## 数字证书
数字证书(D屯ital Certificate) 也称公钥证书，是由证书认证机构(CA) 签名的包含公开密钥拥有者信息、公开密钥、签发者信息、有效期以及扩展信息的一种数据结构。如图3-6 所示是一个国外机构颁发的数字证书样式。
![数字证书示意](https://raw.githubusercontent.com/brvchaos/image/main/20230827233018.png)
为规范数字证书的格式，国家制定了《信息安全技术公钥基础设施数字证书格式》（征求意见稿）。其中，数字证书的基本信息域格式要求如表3-2 所示。
![数字证书格式](https://raw.githubusercontent.com/brvchaos/image/main/20230827233228.png)
用户证书的结构实例如表3-3 所示。
![](https://raw.githubusercontent.com/brvchaos/image/main/20230827233722.png)
数字证书按类别可分为个人证书、机构证书和设备证书，按用途可分为签名证书和加密证书。其中，签名证书是用千证明签名公钥的数字证书。加密证书是用于证明加密公钥的数字证书。
当前，为更好地管理数字证书， 一般是基千PK.I 技术建立数字证书认证系统（简称为CA) 。CA 提供数字证书的申请、审核、签发、查询、发布以及证书吊销等全生命周期的管理服务。数字证书认证系统的构成及部署如图3-7 所示，主要有目录服务器、OCSP 服务器、注册服务器、签发服务器等。
![数字证书认证系统构成及部署](https://raw.githubusercontent.com/brvchaos/image/main/20230827234206.png)
## 安全协议
介绍常见的密钥交换协议及SSH 。
### Diffie-Hellman 密钥交换协议
W.Diffie 和M.E. Hellman 于1976 年首次提出一种共享秘密的方案，简称Dillie-Hellman 密钥交换协议。Dillie-Hellman 密钥交换协议基千求解离散对数问题的困难性，即对千下述等式：
C的d次方 =MmodP
其中， d 称为模P 的以C 为底数的M 的对数，在已知C 和P 的前提下，由d 求M 很容易，只相当于进行一次指数计算。而再由M 反过来求d, 则需要指数级次计算。随着P 取得足够大，
就能实现足够的安全强度。现在假设Alice 和Bob 使用Diffie-Hellman 密钥交换协议，在一个不安全的信道上交换密钥，则其操作步骤如下：第一步， Alice 和Bob 确定一个适当的素数p 和整数a, 并使得a 是p 的原根，其中a 和p 可以公开。
第二步， Alice 秘密选取一个整数aA ，计算YA = aaAmod p' 并把YA 发送给Bob 。
第三步， Bob 秘密选取一个整数aB ，计算yB =aaBmodp ，并把yB 发送给Alice 。YA 和yB
就是所说的Diffie-Hellman 公开值。
第四步， Alice 和Bob 双方分别计算出共享密钥K, 即：
Alice 通过计算K=(y. 尸modp 生成密钥K;
Bob 通过计算K=(yA 尸modp 生成密钥K。
因为：
K=(Ys 尸modp= （沪modp尸modp
= (aa• 尸mod p = aaBaA mod p
= (aaA 尸modp = (a0Amodp尸modp
=(yA 尸modp
所以Alice 和Bob 生成的密钥K 是相同的，这样一来就实现了密钥的交换。Alice 和Bob
采用Diffie-Hellman 密钥交换的安全性基千求解离散对数问题的困难性，即从YA 或者yB 以及a
计算aA 或aB 在计算上是不可行的。
### SSH
SSH 是Secure Shell 的缩写，即“安全外壳”，它是基于公钥的安全应用协议，由SSH 传输层协议、SSH 用户认证协议和SSH 连接协议三个子协议组成，各协议分工合作，实现加密、认证、完整性检查等多种安全服务。SSH 最初是芬兰的学术研究项目， 1998 年开始商业化。SSH研究开发的目的是以一种渐进的方式来增强网络安全，通过利用现代密码技术，增强网络中非
安全的服务。例如Telnet 、Rlogin 、FTP 等，实现服务器认证、用户认证及安全加密网络连接服务。目前， SSH 已有两个版本SSHl 和SSH2, 其中SSHl 因存在漏洞而被停用，现在用户使用的是SSH2 。SSH2 的协议结构如图3-8 所示。
![](https://raw.githubusercontent.com/brvchaos/image/main/20230827235546.png)
SSH 传输层协议提供算法协商和密钥交换，并实现服务器的认证，最终形成一个加密的安全连接，该安全连接提供完整性、保密性和压缩选项服务。SSH 用户认证协议则利用传输层的服务来建立连接，使用传统的口令认证、公钥认证、主机认证等多种机制认证用户。SSH 连接
协议在前面两个协议的基础上，利用已建立的认证连接，并将其分解为多种不同的并发逻辑通道，支持注册会话隧道和TCP 转发(TCP-forwarding) ，而且能为这些通道提供流控服务以及通道参数协商机制。SSH 的工作机制共分7 个步骤，如团3-9 所示。
![](https://raw.githubusercontent.com/brvchaos/image/main/20230827235822.png)
目前，用户为了认证服务器的公钥真实性，有三种方法来实现。第一种，用户直接随身携带含有服务器公钥的拷贝，在进行密钥交换协议前，读入客户计算机；第二种，从公开信道下载服务器的公钥和它对应的指纹后，先通过电话验证服务器的公钥指纹的真实性，然后用HASH 软件生成服务器的公钥新指
纹，比较下载的指纹和新生成的指纹，若比较结果相同，则表明服务器的公钥是真实的，否则服务器的公钥是虚假的；第三种，通过PK.I 技术来验证服务器。
在实际的应用中， SSH 在端口转发技术（如图3-10 所示）的基础上，能够支持远程登录(Telnet) 、rsh 、rlogin 、文件传输(scp) 等多种安全服务。Linux 系统一般提供SSH 服务， SSH的服务进程端口通常为22 。
![](https://raw.githubusercontent.com/brvchaos/image/main/20230827235937.png)
虽然SSH 是一个安全协议，但是也有可能受到中间人攻击和拒绝服务攻击。
